<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MASTIL Debug Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        h1 {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .error-container {
            background-color: #fff0f0;
            border-left: 5px solid #e74c3c;
            padding: 15px;
            margin-bottom: 20px;
        }
        .log-container {
            background-color: #f8f9fa;
            border-left: 5px solid #6c757d;
            padding: 15px;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        .buttons {
            margin: 20px 0;
        }
        button {
            padding: 8px 15px;
            margin-right: 10px;
            background-color: #4F46E5;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #4338CA;
        }
        .debug-info {
            margin-top: 30px;
        }
        #errors, #logs {
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>MASTIL Debug Page</h1>
    
    <div class="buttons">
        <button id="testMain">Test Main Game</button>
        <button id="testComponents">Test Components</button>
        <button id="clearLogs">Clear Logs</button>
    </div>
    
    <h2>Error Log</h2>
    <div class="error-container">
        <div id="errors">No errors detected yet.</div>
    </div>
    
    <h2>Console Log</h2>
    <div class="log-container">
        <div id="logs">No logs yet.</div>
    </div>
    
    <div class="debug-info">
        <h2>Browser Information</h2>
        <p id="userAgent"></p>
        <p id="screenSize"></p>
    </div>
    
    <script>
        // Display browser info
        document.getElementById('userAgent').textContent = `User Agent: ${navigator.userAgent}`;
        document.getElementById('screenSize').textContent = `Screen: ${window.innerWidth}x${window.innerHeight}, Device Pixel Ratio: ${window.devicePixelRatio}`;
        
        // Override console methods to capture logs
        const originalConsole = {
            log: console.log,
            warn: console.warn,
            error: console.error,
            info: console.info
        };
        
        const logsEl = document.getElementById('logs');
        const errorsEl = document.getElementById('errors');
        
        // Format timestamp
        function getTimestamp() {
            const now = new Date();
            return `[${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}.${now.getMilliseconds().toString().padStart(3, '0')}]`;
        }
        
        // Replace console methods
        console.log = function() {
            originalConsole.log.apply(console, arguments);
            const args = Array.from(arguments).map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            logsEl.textContent = `${getTimestamp()} [LOG] ${args}\n${logsEl.textContent}`;
        };
        
        console.warn = function() {
            originalConsole.warn.apply(console, arguments);
            const args = Array.from(arguments).map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            logsEl.textContent = `${getTimestamp()} [WARN] ${args}\n${logsEl.textContent}`;
        };
        
        console.error = function() {
            originalConsole.error.apply(console, arguments);
            const args = Array.from(arguments).map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            errorsEl.textContent = `${getTimestamp()} [ERROR] ${args}\n${errorsEl.textContent}`;
            logsEl.textContent = `${getTimestamp()} [ERROR] ${args}\n${logsEl.textContent}`;
        };
        
        console.info = function() {
            originalConsole.info.apply(console, arguments);
            const args = Array.from(arguments).map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            logsEl.textContent = `${getTimestamp()} [INFO] ${args}\n${logsEl.textContent}`;
        };
        
        // Capture global errors
        window.onerror = function(message, source, lineno, colno, error) {
            const errorInfo = `${message}\nSource: ${source}\nLine:Column: ${lineno}:${colno}\nStack: ${error?.stack || 'N/A'}`;
            errorsEl.textContent = `${getTimestamp()} [GLOBAL ERROR]\n${errorInfo}\n\n${errorsEl.textContent}`;
            return false;
        };
        
        // Test functionality
        document.getElementById('testMain').addEventListener('click', function() {
            try {
                console.log('Loading main game script...');
                const script = document.createElement('script');
                script.type = 'module';
                script.src = './assets/index-LRTwwvIf.js';
                script.onerror = function(e) {
                    console.error('Failed to load main script:', e);
                };
                document.head.appendChild(script);
            } catch (e) {
                console.error('Error testing main game:', e);
            }
        });
        
        document.getElementById('testComponents').addEventListener('click', function() {
            try {
                console.log('Testing graphics components...');
                
                // Test script loading
                const scripts = [
                    'replace-graphics.js',
                    'ensure-graphics.js',
                    'direct-graphics-injector.js'
                ];
                
                scripts.forEach((scriptName, index) => {
                    setTimeout(() => {
                        console.log(`Testing ${scriptName}...`);
                        const script = document.createElement('script');
                        script.src = `./assets/${scriptName}`;
                        script.onerror = function() {
                            console.error(`Failed to load ${scriptName}`);
                        };
                        document.head.appendChild(script);
                    }, index * 1000);
                });
            } catch (e) {
                console.error('Error testing components:', e);
            }
        });
        
        document.getElementById('clearLogs').addEventListener('click', function() {
            logsEl.textContent = 'Logs cleared.';
            errorsEl.textContent = 'Errors cleared.';
        });
        
        // Initial log
        console.log('Debug page loaded successfully');
    </script>
</body>
</html> 